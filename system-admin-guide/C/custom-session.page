<page xmlns="http://projectmallard.org/1.0/"
      type="topic" style="task"
      id="custom-session">
  <info>
    <revision pkgversion="3.4.2" version="0.1" date="2012-12-01" status="draft"
    />
    <link type="guide" xref="index" group="login" />

    <credit type="author copyright">
      <name>minnie_eg</name>
      <email>amany.elguindy@gmail.com</email>
      <years>2012</years>
    </credit>

    <desc>Install a desktop session file.</desc>

    <include href="legal.xml" xmlns="http://www.w3.org/2001/XInclude"/>
  </info>

  <title>Creating a custom session</title>

  <comment>
    <cite date="2012-11-19"
    href="mailto:amany_elguindy@gmail.com">minnie_eg</cite>
    <p>This assumes the reader knows how to edit files as user root and how
    to navigate through a <cmd>man</cmd> page. By the end of this page,
    the reader will be able to create custom sessions with different
    options.</p>
  </comment>

  <p>User sessions can be created using desktop files such as
  <file>/usr/share/xsessions/new-session.desktop</file> which
  may contain the following:</p>
  <code>
  [Desktop Entry]
  Encoding=UTF-8
  Type=Application
  Name=Custom session
  Comment=This is our custom session
  <input>Exec</input>=gnome-session
  </code>
  <p>To display more information on sessions options and
  parameters that an be used with <code>Exec</code>,
  type <cmd>man gnome-session</cmd> into a terminal.
  For example, a debugging session can be created on
  <file>/usr/share/xsessions/debugging.session</file>
  and called by <code>Exec=gnome-session --debug</code>.</p>
  <p>Custom session files that include various parameters can
  be saved in
  <file>/usr/share/gnome-session/sessions/new-session.session</file>
  and then called using
  <code>Exec=gnome-session --session=new-session</code>.</p>

  <p>After the creation of the session desktop file with the user
  root, the new session will be available on the sessions list of the
  GDM log-in screen.</p>

  <section id="issues">
  <title>Known issues</title>
    <p>On a Debian or Debian-based system, if you see the
    following error:</p>

    <screen>Xsession: unable to launch ""
    Xsession --- "" not found; falling back to default
    session.</screen>

    <p>Make the following changes to
    <file>/etc/X11/Xsession.d/20x11-common_process-args</file>:</p>
    <steps>
    <item><p>Change <code>STARTUP_FULL_PATH=$(/usr/bin/which <input>"$1"</input>|| true)</code>
    to <code>STARTUP_FULL_PATH=$(/usr/bin/which <input>$1</input> || true)</code>
    </p></item>
    <item><p>Change <code>STARTUP=<input>"$1"</input></code>
    to <code>STARTUP=<input>$1</input></code>
    </p></item>
    </steps>
  </section>

</page>
